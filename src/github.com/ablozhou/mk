GOCMD=go
GOBUILD=$(GOCMD) build
GOCLEAN=$(GOCMD) clean
GOINSTALL=$(GOCMD) install
GOTEST=$(GOCMD) test
GODEP=$(GOTEST) -i
GOFMT=go fmt -w

ALL_LIST=%.go
BUILD_LIST = $(ALL_LIST)
all: build
build: $(BUILD_LIST)
	$(GOBUILD) $(TOPLEVEL_PKG)/$*
clean: $(CLEAN_LIST)
install: $(INSTALL_LIST)
test: $(TEST_LIST)
iref: $(IREF_LIST)
fmt: $(FMT_TEST)

#myhostname := $(shell hostname)
#ifeq (${myhostname}, laptop)
#    GOPATH := /home/andy/gocode
#else ifeq (${myhostname}, minta)
#    GOPATH := /home/andy/gocode
#    GOROOT := /home/andy/go
#endif

build: 
	buildall
buildall: common.go server.go client.go chatit.go
    # always format code
    GOPATH=$(GOPATH) go fmt $^
    # binary
    #go build -o chatit -v $^
    #go build -v $^
    # docs
    #markdown README.md > README.html
    #help2man --no-info --include=help2man.roff --name "chatit" ./chatit > chatit.roff
    #man -Tps -l chatit.roff > chatit-man.ps
    #ps2pdf chatit-man.ps chatit-man.pdf
    # mark as done
    #touch $@
